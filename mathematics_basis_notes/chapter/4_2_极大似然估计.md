# 极大似然估计
## 简介
&#8195;  极大似然估计，通俗理解来说，就是**利用已知的样本结果信息，反推最具有可能（最大概率）导致这些样本结果出现的模型参数值**。换句话说，极大似然估计提供了一种给定观察数据来评估模型参数的方法，即：“模型已定，参数未知”。

&#8195;  我们这样想，一当模型满足某个分布，它的参数值我通过极大似然估计法求出来的话。比如正态分布中公式如下：
$$f(x) = \frac{1}{\sqrt{2\pi} \sigma}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}$$

&#8195;  如果我通过极大似然估计，得到模型中参数$\mu$和$\sigma$的值，我们就得到了这个模型的均值和方差以及其它所有的信息。**极大似然估计中采样需满足一个重要的假设，就是所有的采样都是独立同分布的。**

&#8195;  首先看一下似然函数 $P(x|\theta)$，其中x表示某一个具体的数据，$\theta$表示模型的参数。对于函数$P(x|\theta)$：

* 如果$\theta$是已知确定的，x是变量，这个函数叫做概率函数(probability function)，它描述对于不同的样本点x，其出现概率是多少。

* 如果x是已知确定的， $\theta$是变量，这个函数叫做似然函数(likelihood function)，它描述对于不同的模型参数，出现x这个样本点的概率是多少。

    * 举个类似的例子：$f(x,y) = x^y $，即x的y次方；
    * 当x=2时，$f(y) = 2^y$，此时f(y)为指数函数；
    * 当y=2时，$f(x)=x^2$，此时f(x)为二次函数；
    * 同一个数学形式，从不同的变量角度观察，可以有不同的名字。

## 例子1
&#8195;  假如有一个罐子，里面有黑白两种颜色的球，数目多少不知，两种颜色的比例也不知。我们想知道罐中白球和黑球的比例，但我们不能把罐中的球全部拿出来数。

* 现在我们可以每次任意从已经摇匀的罐中拿一个球出来，记录球的颜色，然后把拿出来的球 再放回罐中。
* 这个过程可以重复，我们可以用记录的球的颜色来估计罐中黑白球的比例。
* 假如在前面的一百次重复记录中，有七十次是白球，请问罐中白球所占的比例最有可能是多少？

&#8195;  很多人马上就有答案了：70%。而其后的理论支撑是什么呢？

* 1. 我们假设罐中白球的比例是p，那么黑球的比例就是1-p。因为每抽一个球出来，在记录颜色之后，我们把抽出的球放回了罐中并摇匀，所以每次抽出来的球的颜色**服从同一独立分布**。

* 2. 这里我们把一次抽出来球的颜色称为一次抽样。题目中在一百次抽样中，七十次是白球的,三十次为黑球事件的概率是P(样本结果|Model)。

* 3. 如果第一次抽象的结果记为$x_1$，第二次抽样的结果记为$x_2....$，那么样本结果为$(x_1,x_2.....,x_{100})$。这样，我们可以得到如下表达式：
$$\begin{aligned}
P(x|\theta) & = P(x_1,x_2,...,x_{100}|\theta) \\
 & = P(x_1|\theta)P(x_2|\theta)...P(x_{100}|\theta) \\
 & = P^{70} \cdot (1-p)^{30} \\
\end{aligned}$$

* 4. 我们已经有了观察样本结果出现的概率表达式了。那么我们要求的模型的参数，也就是求的式中的p。从前面的式子中可以知道不同的p，直接导致P（样本结果|Model）的不同。

* 5. 如此一来，p实际上是有无数种分布的。如下所示：

|P(白球的比例)|(1-P)(黑球的比例)|
|:---:|:---:|
|50%|50%|

* p=50%时，那么$\theta = p^{50}\cdot(1-p)^{50}$

|P(白球的比例)|1-P(黑球的比例)|
|:---:|:---:|
|70%|30%|

* p=70%时，那么$\theta = p^{70}\cdot(1-p)^{30}$

&#8195;  既然有无数种分布可以选择，极大似然估计应该按照**让这个样本结果出现的可能性最大**这个原则去选取这个分布，也就是使得$p^{70}(1-p)^{30}$值最大，那么我们就可以看成是p的方程，求导即可！

&#8195;  那么既然事情已经发生了，为什么不让这个出现的结果的可能性最大呢？这也就是最大似然估计的核心。我们想办法让观察样本出现的概率最大，转换为数学问题就是使得：

&#8195;  对$f(p)=p^{70}(1-p)^{30}$求导，使其导数为0，得到的p值带入$f(p)$；

$$\frac{\partial f(p)}{\partial p} = 0 \implies p=0.7$$

$$\quad f(0.7) = (0.7)^{70} \cdot (1-0.7)^{30}$$

这样得到的结果就是f(p)的最大值。

## 例子2
&#8195;  假设我们要统计全国人民的年均收入，首先假设这个收入服从服从正态分布，但是该分布的均值与方差未知。我们没有人力与物力去统计全国每个人的收入。我们国家有10几亿人口呢？

* 1. 我们可以采用极大似然估计。我们比如选取一个城市，或者一个乡镇的人口收入，作为我们的观察样本结果。然后通过最大似然估计来获取上述假设中的正态分布的参数。

* 2. 有了参数的结果后，我们就可以知道该正态分布的期望和方差了。也就是我们通过了一个小样本的采样，反过来知道了全国人民年收入的一系列重要的数学指标量！

* 3. 那么我们就知道了极大似然估计的核心关键就是对于一些情况，样本太多，无法得出分布的参数值，可以采样小样本后，利用极大似然估计获取假设中分布的参数值。
